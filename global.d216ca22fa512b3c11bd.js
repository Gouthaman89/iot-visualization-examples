(()=>{"use strict";var e,t={6861:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=o(2866),i=o(9825);o(2263);const r=window.THREE;t.default=class{constructor(e,t,o,n){const i=this.options=n||{};this.startPoint=t,this.endPoint=o,this.controlPoint=i.controlPoint||this.calculateControlPoint(),this.space=e,this.init()}calculateControlPoint(){const e=new r.Vector3(0,0,0);return e.addVectors(this.startPoint,this.endPoint),e.multiplyScalar(.9),this.options.line||(e.y=this.endPoint.distanceTo(this.startPoint)),e}init(){const e=this.curve=new r.QuadraticBezierCurve3(this.startPoint,this.controlPoint,this.endPoint);this.points=e.getPoints(60);const t=[];this.points.forEach((e=>{t.push(e.x),t.push(e.y),t.push(e.z)}));const o=new r.BufferGeometry;let n;if(o.addAttribute("position",new r.BufferAttribute(new Float32Array(t),3)),this.options.pointModel){const e=new r.PointsMaterial({size:this.options.pointSize||1,vertexColors:r.VertexColors});n=new r.Points(o,e)}else{const e=new r.MeshBasicMaterial({vertexColors:r.VertexColors});n=new r.Line(o,e)}return this.object3d=n,this.space.scene.add(n),this}initOutline(){const e=this.space;e.outlinePassMap.has("curve")||e.setOutlinePass("curve",{edgeGlow:1,edgeStrength:5,hiddenEdgeColor:16777215,pulsePeriod:2,visibleEdgeColor:16777215}),e.getOutlineArray("curve").push(this.object3d)}getPoint(e){if(e>1||e<0)return console.error("t should between 0 and 1.But t is ",e),null;const t=Number((60*e).toFixed(0));return this.points[t]}addPointEasing(){const e=this;i.select({}).transition().duration(1500).tween("point-easing",(()=>{const t=new r.SphereGeometry(.08,12,12),o=new r.LineBasicMaterial({color:16777215}),n=new r.Mesh(t,o);return this.space.scene.add(n),t=>{const o=e.getPoint(t);n.position.copy(o),t>=1&&e.space.scene.remove(n)}}))}colorEasing(e,t,o,s){const a=[],c=this.object3d.geometry.attributes.position.count,l=o||n.easeExpInOut,d=(!!s&&s.repeat,n.interpolateHsl(e||"#aaaaaa",t||"#00ffff"));for(let e=0;e<c;e++){const t=d(l(e/c)).match(/\d+/g);a[3*e]=Number(t[0])/255,a[3*e+1]=Number(t[1])/255,a[3*e+2]=Number(t[2])/255}this.object3d.geometry.addAttribute("color",new r.Float32BufferAttribute(a,3)),i.select({}).transition().duration(2e3).ease(n.easeLinear).tween("color-easing",(()=>e=>{const t=Number((e*c).toFixed(0)),o=a.slice(3*t),n=a.slice(0,3*t),i=[].concat(o,n);this.object3d.geometry.addAttribute("color",new r.Float32BufferAttribute(i,3))}))}positionEasing(e,t){i.select({}).transition().duration(2e3).tween("color-easing",(()=>{const o=n.interpolateNumber(e.x,t.x),i=n.interpolateNumber(e.y,t.y),r=n.interpolateNumber(e.z,t.z);return e=>{this.object3d.position.set(o(e),i(e),r(e))}}))}}},5238:(e,t,o)=>{o(723);const n=o(6861),i=o(6213),r=$("#3d-space")[0],s=new i.default(r,{orbit:!0});window.debugSpace=s;const a=window.THREE;function c(e){return t=>e*t%1}s.createEmptyScene(),s.camera.position.set(69,88,-157),s.camera.rotation.set(-2.6,.36,2.94),s.orbit.update();let l,d;const u={users:[{id:0,name:"John Yang",geo:{lat:31.2304,lng:121.4737,name:"Shanghai, CN"},date:"01.23.2018"},{id:1,name:"Emma S.",geo:{lat:55.6761,lng:12.5683,name:"Denmark, CPH"},date:"09.20.2018"}]},h=window.canvasDebug=document.createElement("canvas"),p=window.ctxDebug=h.getContext("2d"),f=window.img1=new Image;function g(e,t){const o=e*Math.PI/180,n=(t-180)*Math.PI/180,i=-49*Math.cos(o)*Math.cos(n),r=49*Math.sin(o),s=49*Math.cos(o)*Math.sin(n);return new a.Vector3(i,r,s)}f.onload=function(){p.canvas.height=f.height,p.canvas.width=f.width,p.drawImage(f,0,0),l=p.canvas.width/2,d=p.canvas.height/2,u.users.forEach((e=>{const t=function(e,t){const o=2*Math.round((t+180)*(l/360)),n=2*Math.round(d/180*(-1*e+90));return console.log("convertLatLngToFlatCoords:",e,t,o,n),{x:o,y:n}}(e.geo.lat,e.geo.lng);console.log("convertFlatCoordsToSphereCoords",function(e,t){let o=(e-l)/l*-180,n=(t-d)/d*-90;o=o*Math.PI/180,n=n*Math.PI/180;const i=50*Math.cos(n);return{x:Math.cos(o)*i,y:50*Math.sin(n),z:Math.sin(o)*i}}(t.x,t.y)),console.log("convertLatLngToSphereCoords",g(e.geo.lat,e.geo.lng));const o=new Path2D;o.arc(t.x,t.y,3,0,2*Math.PI),p.fillStyle="rgba(0,255,255,0.8)",p.fill(o)}));const e=new a.CanvasTexture(p.canvas),t=new a.SphereGeometry(50,32,32),o=new a.MeshBasicMaterial({map:e,transparent:!0,side:a.DoubleSide,depthTest:!1,depthWrite:!1}),i=new a.Mesh(t,o);s.scene.add(i),document.body.appendChild(h);const r=u.users[0].geo,b=u.users[1].geo,w=g(r.lat,r.lng),m=g(b.lat,b.lng),v=new n.default(s,w,m,{pointModel:!0,pointSize:.8});v.colorEasing("#0000ff","#00ffff",c(3)),setInterval((()=>{v.colorEasing("#0000ff","#00ffff",c(3))}),2e3)},f.src="./static/images//global9.png"}},o={};function n(e){var i=o[e];if(void 0!==i)return i.exports;var r=o[e]={id:e,loaded:!1,exports:{}};return t[e].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.m=t,e=[],n.O=(t,o,i,r)=>{if(!o){var s=1/0;for(d=0;d<e.length;d++){for(var[o,i,r]=e[d],a=!0,c=0;c<o.length;c++)(!1&r||s>=r)&&Object.keys(n.O).every((e=>n.O[e](o[c])))?o.splice(c--,1):(a=!1,r<s&&(s=r));if(a){e.splice(d--,1);var l=i();void 0!==l&&(t=l)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[o,i,r]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{n.b=document.baseURI||self.location.href;var e={172:0};n.O.j=t=>0===e[t];var t=(t,o)=>{var i,r,[s,a,c]=o,l=0;if(s.some((t=>0!==e[t]))){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(c)var d=c(n)}for(t&&t(o);l<s.length;l++)r=s[l],n.o(e,r)&&e[r]&&e[r][0](),e[s[l]]=0;return n.O(d)},o=self.webpackChunkiot_visualization_examples=self.webpackChunkiot_visualization_examples||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var i=n.O(void 0,[86,866,606],(()=>n(5238)));i=n.O(i)})();